<!DOCTYPE html>
<html lang="en" dir="ltr">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How to extract the complete works of Shakespeare from an image | rooyca</title>
<meta name="keywords" content="steganography, linux" />
<meta name="description" content="Would you like to read the complete work of one of the greats of English literature but think it&#39;s too long to download? Well, today I have the solution for you. We&#39;re going to extract it from a small image (2 MB).">
<meta name="author" content="rooyca">
<link rel="canonical" href="/en/articles/esteganografia_basica/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.7bfe087ae72df31787ec7a1360dd05ee246a179b51cf7a30a904b39d7f813b69.css" integrity="sha256-e/4Ieuct8xeH7HoTYN0F7iRqF5tRz3owqQSznX&#43;BO2k=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js" integrity="sha256-uVus3DnjejMqn4g7Hni&#43;Srwf3KK8HyZB9V4809q9TWE="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="mask-icon" href="/images/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/en/articles/esteganografia_basica/" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="en/" accesskey="h" title="rooyca (Alt + H)">rooyca</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="/es/" title="Spanish"
                            aria-label="Spanish">Spanish</a>
                    </li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="en/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="en/articles/" title="Articles">
                    <span>Articles</span>
                </a>
            </li>
            <li>
                <a href="en/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="en/">Home</a></div>
    <h1 class="post-title">
      How to extract the complete works of Shakespeare from an image
    </h1>
    <div class="post-description">
      Would you like to read the complete work of one of the greats of English literature but think it&#39;s too long to download? Well, today I have the solution for you. We&#39;re going to extract it from a small image (2 MB).
    </div>
    <div class="post-meta"><span title='2021-09-23 00:00:00 +0000 UTC'>September 23, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;rooyca</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#esteganograf%c3%ada" aria-label="Esteganografía">Esteganografía</a><ul>
                        
                <li>
                    <a href="#qu%c3%a9-es" aria-label="¿Qué es?">¿Qué es?</a></li>
                <li>
                    <a href="#c%c3%b3mo-funciona" aria-label="¿Cómo funciona?">¿Cómo funciona?</a></li>
                <li>
                    <a href="#c%c3%b3mo-usarla" aria-label="¿Cómo usarla?">¿Cómo usarla?</a><ul>
                        
                <li>
                    <a href="#1-ocultando-informaci%c3%b3n" aria-label="1. Ocultando información">1. Ocultando información</a></li>
                <li>
                    <a href="#2-extrayendo-informaci%c3%b3n" aria-label="2. Extrayendo información">2. Extrayendo información</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content">
  <h1 id="esteganografía">Esteganografía</h1>
<h2 id="qué-es">¿Qué es?</h2>
<p>A diferencia de la criptografía, donde es obvio que se está ocultando algo, la esteganografía oculta la información de tal forma que no se levante sospechas de que hay algo oculto. Esto se consigue por medio de diferentes técnicas que nos permiten ocultar archivos, imágenes, textos o incluso vídeos dentro de otros archivos.</p>
<h2 id="cómo-funciona">¿Cómo funciona?</h2>
<p>Hay diferentes técnicas para ocultar información dentro de archivos. Una de las más usadas y quizás la más sencilla de entender es la comúnmente conocido como &ldquo;Técnica del Bit menos significante&rdquo; o LSB (por sus siglas en inglés).</p>
<p>Esta técnica lo que hace es cambiar algunos de los últimos bits en un byte para codificar el mensaje. Esto es útil en imágenes, donde el valor del rojo, verde y azul están representados por bits (un byte) en un rango de 0 a 255 (ver <a href="https://en.wikipedia.org/wiki/RGB">RGB</a>) en decimales o de 00000000 a 11111111 en binario.</p>
<p>Cambiar el valor de los últimos dos bits en un pixel completamente rojo de: 11111111 a 11111101 unicamente cambia el valor de rojo de 255 a 253, lo cual a simple vista crea un cambio prácticamente imperceptible, pero que aún así nos permite ocultar información dentro de la imagen.</p>
<p><img loading="lazy" src="https://res.cloudinary.com/rooyca/image/upload/v1632442360/Blog/Imgs/steganography/lsb_drvccm.jpg" alt="LSB"  />

El anterior diagrama muestra dos imágenes de 4 pixeles cada una, junto a su respectivo valor binario. (<a href="https://null-byte.wonderhowto.com/how-to/steganography-hide-secret-data-inside-image-audio-file-seconds-0180936/">Fuente</a>)</p>
<p>Como dijimos anteriormente, esta técnica funciona muy bien con archivos multimedia, pero no tanto con archivos de texto ASCII donde un simple bit puede cambiar los caracteres completamente. Sin mencionar que el LSB es la técnica más sencilla de detectar.</p>
<h2 id="cómo-usarla">¿Cómo usarla?</h2>
<p>Recuerda que hay muchas técnicas de esteganografía, unas mejores que otras. Por lo general lo mejor es evitar la LSB e ir por algo un poco más sofisticado. Incluso, ¿por qué no?, diseñar tu propio algoritmo de esteganografía.</p>
<p>También es importante tener presentes los conceptos de encriptar y comprimir. Si encriptamos la información antes de ocultarla le añadimos una capa más de seguridad, mientras que comprimir la información nos permitirá añadirle más información a nuestro archivo.</p>
<p>Para el desarrollo de este tutorial, vamos a utilizar Steghide, una herramienta sencilla de usar pero no por ello menos eficaz.</p>
<h3 id="1-ocultando-información">1. Ocultando información</h3>
<p>Primeramente vamos a instalar Steghide, por medio de apt.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get install steghide
</span></span></code></pre></div><p>Una vez instalado procemos a ocultar nuestra información, con el siguiente comando:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">steghide embed -ef archivoSecreto -cf archivoDePortada -sf archivoFinal -z nivelDeCompresion -e esquema
</span></span></code></pre></div><p>Ahora vamos a explicar los argumentos que acabamos de utilizar:</p>
<ul>
<li><strong>-ef</strong> especifica la ruta del archivo que queremos ocultar. Podemos ocultar cualquier tipo de archivos dentro de nuestro archivo, incluyento scripts en Python.</li>
<li><strong>-cf</strong> este es el archivo en el cual ocultaremos nuestra información. Aquí si hay restricciones, solo se permiten archivos del tipo BMP, JPEG, WAV y AU.</li>
<li><strong>-sf</strong> es un argumento opcional que especifica el nombre del archivo resultante de esta &ldquo;unión&rdquo;. Si no lo especificamos el archivo original será sobrescrito.</li>
<li><strong>-z</strong> especifica el nivel de compresión, en un rango de 1 a 9. Si prefiere no comprimir su archivo use el argumente <strong>-Z</strong></li>
<li><strong>-e</strong> especifica el tipo de encriptación. Steghide soporta una gran cantidad de esquemas de encriptación y si se omite este argumento Steghide usará la opción por defecto que es 128-bit AES. Si prefieres no usar encriptacion simplemtente escribe <strong>-e none</strong></li>
</ul>
<p>En el siguiente ejemplo, ocultaré un archivo de texto dentro de una imagen de un tierno cachorro (para levantar menos sospecha 😉). El archivo final se llamará &ldquo;perrito-secreto.jpeg&rdquo;, no voy a hacer uso del compresor ni del encriptador, y el comando en la terminal luciría algo así:</p>
<p><code>steghide embed -ef secret.txt -cf perrito.jpeg -sf perrito-secreto.jpeg -e none -Z</code></p>
<p>Después de ingresar nuestro comando Steghide nos pedirá que le asignemos una contraseña a nuestro archivo. Una vez ingresamos la passphrase tendremos nuestro archivo con información confidencial dentro de él 😄.</p>
<p><img loading="lazy" src="https://res.cloudinary.com/rooyca/image/upload/v1632446520/Blog/Imgs/steganography/info-ocul_d2mpa7.png" alt="PERRITO-SEC"  />
</p>
<p>El resultado sería una imagen común y corriente&hellip; Si deseas saber lo que hay dentro del archivo de texto, aquí te dejo la imagen (password: topsecret):</p>
<p><img loading="lazy" src="https://res.cloudinary.com/rooyca/image/upload/v1632446478/Blog/Imgs/steganography/perrito-secreto_xgzjlc.jpg" alt="PERRITO"  />
</p>
<h3 id="2-extrayendo-información">2. Extrayendo información</h3>
<p>El proceso de extraer la información de nuestros archivos es incluso más sencillo. El comando que deberemos ejecutar es el siguiente:</p>
<p><code>steghide extract -sf archivoSecreto -xf archivoFinal</code></p>
<p>Cuando ejecutamos este comando nos pedirá la contraseña, la ingresamos y deberíamos tener todos los archivos que se encontraban dentro del <code>archivoSecreto</code></p>
<p>Ahora bien, te estarás preguntando, ¿cómo hago para extraer información de un archivo si no tengo la contraseña? Pues actualmente existen infinidad de herramientas que nos pueden ayudar con eso. Pero el día de hoy vamos a hacer uso de <a href="https://github.com/ReFirmLabs/binwalk/tree/master"><strong>binwalk</strong></a>.</p>
<p>Como lo prometí en un principio, vamos a extraer la obra completa de Shakespeare de la siguiente imagen:</p>
<p><img loading="lazy" src="https://res.cloudinary.com/rooyca/image/upload/v1632447298/Blog/Imgs/steganography/shakespeare_hempxe.jpg" alt="SHAKESPEARE"  />
</p>
<blockquote>
<p>O si prefieres puedes visitar el post original en <a href="https://twitter.com/David3141593/status/1058124224798380032">Twitter</a>.</p>
</blockquote>
<p>Al correr nuestro binwalk (<code>binwalk shakespeare.jpg</code>) nos indica que la imagen esta compuesta de 31 archivos RAR.</p>
<p><img loading="lazy" src="https://res.cloudinary.com/rooyca/image/upload/v1632447713/Blog/Imgs/steganography/data-shake_ta3h6y.png" alt="DATA-SP"  />
</p>
<p>Procedemos a extraer los archivos de la siguiente manera
<code>binwalk  -e -C ./shake shakespeare.jpeg</code></p>
<p><img loading="lazy" src="https://res.cloudinary.com/rooyca/image/upload/v1632448228/Blog/Imgs/steganography/final-html_ios0md.png" alt="FILEs"  />
</p>
<p>Lo que creará una carpeta &ldquo;shake&rdquo; en nuestro directorio actual. Al ejecutar el comando nos extraerá los 31 archivos RAR, y al extraer el primero de ellos(<code>shakespeare.-part001.rar</code>) nos quedará un último archivo llamado <code>shakespeare.html</code> que al abrirlo, nos saldrá algo así:</p>
<p><img loading="lazy" src="https://res.cloudinary.com/rooyca/image/upload/v1632448228/Blog/Imgs/steganography/html1_az1vsv.png" alt="FILES-FINAL"  />
</p>
<p>¿Increíble no?</p>
<p>Bueno, eso sería todo por el día de hoy. Si quieres expander tus conocimientos sobre este tema te recomiendo leer <a href="https://linuxhint.com/hide_files_inside_images_linux/">este</a> y <a href="https://ostechnix.com/hide-files-inside-images-linux/">este</a> articulo. ¿Eso no es suficiente? Te recomiendo <a href="https://academy.hoppersroppers.org/course/view.php?id=7#section-4">este</a> curso de CTF, que abarca estos temas y muchos más. Y recuerda, si tienes alguna duda, queja, sugerencia o reclamo no dudes en hacérmelo saber.</p>
<hr>
<ul>
<li>Discord: rooyca#6075</li>
<li>Telegram: @seiseiseis</li>
<li>Mastodon: @rooyca@mas.to</li>
</ul>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/en/tags/steganography/">steganography</a></li>
      <li><a href="/en/tags/linux/">linux</a></li>
    </ul>

<div class="share-buttons">

    <a target="_blank" rel="noopener noreferrer" aria-label="share How to extract the complete works of Shakespeare from an image on linkedin"
        href="https://www.linkedin.com/in/heycharlola/">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>© 2023</span>
    <span>||</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>

</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
